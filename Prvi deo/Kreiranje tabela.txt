CREATE TABLE POLICAJAC
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	IME VARCHAR2(35) NOT NULL,
	IME_RODITELJA VARCHAR2(35),
	PREZIME VARCHAR2(35) NOT NULL,
	DATUM_RODJENJA DATE NOT NULL,
	DATUM_PRIJEMA DATE NOT NULL,
	ADRESA VARCHAR2(50) NOT NULL,
	POL VARCHAR2(1) NOT NULL,
	NAZIV_SKOLE_KURSA VARCHAR2(50)  NOT NULL,
	DATUM_STICANJA_DIPLOME date NOT NULL,
	CIN VARCHAR2(35) NOT NULL,
	DATUM_STICANJA_CINA DATE NOT NULL,
	POLICIJSKA_STANICA_ID INTEGER NOT NULL
	--CONSTRAINT POLICIJSKA_STANICA_FK FOREIGN KEY(POLICIJSKA_STANICA_ID) REFERENCES POLICIJSKA_STANICA(ID)
);

CREATE TABLE VANREDNA_SITUACIJA
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	NAZIV_VESTINE VARCHAR2(35) NOT NULL,
	POHADJAO_KURS VARCHAR2(2),
	DATUM_ZAVRSETKA_KURSA DATE ,
	POSEDUJE_SERTIFIKAT VARCHAR2(2),
	DATUM_STICNJA_SERTIFIKATA DATE ,
	CONSTRAINT POLICAJAC_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)
);

CREATE TABLE SKOLSKI
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	NAZIV_SKOLE VARCHAR2(50),
	ADRESA VARCHAR2(50),
	TIP_SKOLE VARCHAR2(35),
	OSOBA_ZA_KONTAKT VARCHAR2(50),
	CONSTRAINT POLICAJAC_SK_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)
);

CREATE TABLE POZORNIK
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_PO_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)
);

CREATE TABLE NACELNIK
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_NA_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)
);

CREATE TABLE ZAMENIK_ZA_VANREDNE_SITUACIJE
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_ZVS_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)
);

CREATE TABLE ZAMENIK_ZA_KRVNE_DELIKTE
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_ZKD_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)
);

CREATE TABLE ZAMENIK_ZA_SAOBRACAJ
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_ZS_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)
);

CREATE TABLE SEF
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_SEF_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)

);

CREATE TABLE ZAMENIK_SEFA
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_ZAMENIK_SEFA_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)

);

CREATE TABLE SLUZBENO_VOZILO
(
	REGISTARSKA_OZNAKA VARCHAR2(10) PRIMARY KEY,
	BOJA VARCHAR2(15),
	PROIZVODJAC VARCHAR2(35) NOT NULL,
	MODEL VARCHAR2(35) NOT NULL,
	TIP VARCHAR2(35) NOT NULL
);

CREATE TABLE OSTALI
(
	JMBG VARCHAR2(13) PRIMARY KEY,
	CONSTRAINT POLICAJAC_OSTALI_FK FOREIGN KEY(JMBG) REFERENCES POLICAJAC(JMBG)							
);

CREATE TABLE PATROLA
(
	REDNI_BROJ INTEGER PRIMARY KEY,
	VODJA_JMBG VARCHAR2(13) NOT NULL,
	CLAN_JMBG VARCHAR(13) NOT NULL,
	REGISTRACIJA_VOZILA VARCHAR2(10) NOT NULL,
	CONSTRAINT VODJA_FK FOREIGN KEY(VODJA_JMBG) REFERENCES OSTALI(JMBG),	
	CONSTRAINT CLAN_FK FOREIGN KEY(CLAN_JMBG) REFERENCES OSTALI(JMBG),
	CONSTRAINT VOZILO_FK FOREIGN KEY(REGISTRACIJA_VOZILA) REFERENCES SLUZBENO_VOZILO(REGISTARSKA_OZNAKA)
);



CREATE TABLE POLICIJSKA_STANICA
(
	ID INTEGER PRIMARY KEY,
	NAZIV VARCHAR2(50) NOT NULL,
	ADRESA VARCHAR2(50) NOT NULL,
	BROJ_SLUZBENIH_VOZILA INTEGER NOT NULL,
	OPSTINA VARCHAR2(50) NOT NULL,
	DATUM_OSNIVANJA DATE NOT NULL
);

ALTER TABLE POLICAJAC ADD CONSTRAINT STANICA_POLICAJAC_FK FOREIGN KEY(POLICIJSKA_STANICA_ID) REFERENCES POLICIJSKA_STANICA(ID);

CREATE TABLE OBJEKAT 
(
	ID INTEGER PRIMARY KEY,
	ADRESA VARCHAR2(50) NOT NULL,
	TIP VARCHAR2(35) NOT NULL,
	POVRSINA INTEGER NOT NULL,
	IME VARCHAR2(50) NOT NULL,
	PREZIME VARCHAR2(50) NOT NULL,
	POLICIJSKA_STANICA_ID INTEGER NOT NULL,
	CONSTRAINT POLICIJSKA_STANICA_FK FOREIGN KEY(POLICIJSKA_STANICA_ID) REFERENCES POLICIJSKA_STANICA(ID)
);

CREATE TABLE ALARMNI_SISTEM
(
	SERIJSKI_BROJ INTEGER PRIMARY KEY,
	GODINA_PROIZVODNJE INTEGER NOT NULL,
	MODEL VARCHAR2(35) NOT NULL,
	DATUM_INSTALACIJE DATE  NOT NULL,
	DATUM_POSLEDNJEG_ATESTA DATE NOT NULL,
	DATUM_POSLEDNJEG_SERVISA DATE NOT NULL,
	OPIS_POSLEDNJEG_KVARA VARCHAR2(100) NOT NULL,
	TEHNICKO_LICE VARCHAR2(50) NOT NULL,
	POCETNI_DATUM DATE NOT NULL,
	POSLEDNJI_DATUM DATE NOT NULL,
	ID_OBJEKTA INTEGER NOT NULL,
	CONSTRAINT OBJEKAT_FK FOREIGN KEY(ID_OBJEKTA) REFERENCES OBJEKAT(ID)
);
    


CREATE TABLE TOPLOTNI_ODRAZ 
(
	SERIJSKI_BROJ INTEGER PRIMARY KEY,
	HORIZONTALNA_REZOLUCIJA INTEGER NOT NULL,
	VERTIKALNA_REZOLUCIJA INTEGER NOT NULL,
	CONSTRAINT ALARMNI_SISTEM_TO_FK FOREIGN KEY(SERIJSKI_BROJ) REFERENCES ALARMNI_SISTEM(SERIJSKI_BROJ)
);

CREATE TABLE POKRET
(
	SERIJSKI_BROJ INTEGER PRIMARY KEY,
	OSETLJIVOST INTEGER NOT NULL,
	CONSTRAINT ALARMNI_SISTEM_POKRET_FK FOREIGN KEY(SERIJSKI_BROJ) REFERENCES ALARMNI_SISTEM(SERIJSKI_BROJ)
);

CREATE TABLE ULTRAZVUK
(
	SERIJSKI_BROJ INTEGER PRIMARY KEY,
	DONJA_FREKVENCIJA INTEGER NOT NULL,
	GORNJA_FREKVENCIJA INTEGER NOT NULL,
	CONSTRAINT ALARMNI_SISTEM_ULTRAZVUK_FK FOREIGN KEY(SERIJSKI_BROJ) REFERENCES ALARMNI_SISTEM(SERIJSKI_BROJ)
);

CREATE TABLE POLICIJSKA_INTERVENCIJA
(
	ID INTEGER PRIMARY KEY,
	DATUM_INTERVENCIJE DATE NOT NULL,
	OPIS_INTERVENCIJE VARCHAR2(150),
	VREME_INTERVENCIJE TIMESTAMP WITH LOCAL TIME ZONE NOT NULL,
	REDNI_BROJ_PATROLE INTEGER NOT NULL,
	ID_OBJEKTA INTEGER NOT NULL,
	CONSTRAINT PATROLA_INTER_FK FOREIGN KEY(REDNI_BROJ_PATROLE) REFERENCES PATROLA(REDNI_BROJ),
	CONSTRAINT OBJEKAT_INTER_FK FOREIGN KEY(ID_OBJEKTA) REFERENCES OBJEKAT(ID)
);


CREATE TABLE SKOLSKI_BROJ_TELEFONA
(
	BROJ VARCHAR2(20) PRIMARY KEY,
	JMBG_SKOLSKOG_POLICAJCA VARCHAR2(13) NOT NULL,
	CONSTRAINT SKOLSKI_P_FK FOREIGN KEY(JMBG_SKOLSKOG_POLICAJCA) REFERENCES SKOLSKI(JMBG)
);



CREATE TABLE OBJEKAT_BROJ_TELEFONA
(
	BROJ VARCHAR2(20) PRIMARY KEY,
	ID_OBJEKTA INTEGER NOT NULL,
	CONSTRAINT OBJEKAT_BT_FK FOREIGN KEY(ID_OBJEKTA) REFERENCES OBJEKAT(ID)
);



CREATE TABLE NACELNIK_ZAMENIK
(
	ID INTEGER PRIMARY KEY,
	JMBG_NACELNIKA VARCHAR2(13) NOT NULL,
	JMBG_ZVS VARCHAR2(13) NOT NULL,
	JMBG_ZKD VARCHAR2(13) NOT NULL,
	JMBG_ZS VARCHAR2(13) NOT NULL,
	CONSTRAINT NACELNIK_FK FOREIGN KEY(JMBG_NACELNIKA) REFERENCES NACELNIK(JMBG),
	CONSTRAINT ZAMENIK_VS_FK FOREIGN KEY(JMBG_ZVS) REFERENCES ZAMENIK_ZA_VANREDNE_SITUACIJE(JMBG),
	CONSTRAINT ZAMENIK_KD_FK FOREIGN KEY(JMBG_ZKD) REFERENCES ZAMENIK_ZA_KRVNE_DELIKTE(JMBG),
	CONSTRAINT ZAMENIK_S_FK FOREIGN KEY(JMBG_ZS) REFERENCES ZAMENIK_ZA_SAOBRACAJ(JMBG)	
);

CREATE TABLE SEF_ZAMENIK_POLICIJSKA_STANICA
(
	POLICIJSKA_STANICA_ID INTEGER PRIMARY KEY,
	SEF_JMBG VARCHAR2(13) NOT NULL,
	ZAMENIK_JMBG VARCHAR2(13) NOT NULL,
	CONSTRAINT STANICA_FK FOREIGN KEY(POLICIJSKA_STANICA_ID) REFERENCES POLICIJSKA_STANICA(ID),
	CONSTRAINT SEF_FK FOREIGN KEY(SEF_JMBG) REFERENCES SEF(JMBG),
	CONSTRAINT ZAMENIK_FK FOREIGN KEY(ZAMENIK_JMBG) REFERENCES ZAMENIK(JMBG)
);


CREATE SEQUENCE SK_NACELNIK_ZAMENIK START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE SK_OBJEKAT START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE SK_POLICIJSKA_STANICA START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE SK_POLICIJSKA_INTERVENCIJA START WITH 1 INCREMENT BY 1;



CREATE OR REPLACE TRIGGER P_INTER_TRIGER BEFORE 
INSERT ON POLICIJSKA_INTERVENCIJA
FOR EACH ROW 
BEGIN 
SELECT 
SK_POLICIJSKA_INTERVENCIJA.NEXTVAL INTO :NEW.ID 
FROM DUAL;
END;

CREATE OR REPLACE TRIGGER P_STANICA_TRIGER BEFORE 
INSERT ON POLICIJSKA_STANICA
FOR EACH ROW 
BEGIN 
SELECT 
SK_POLICIJSKA_STANICA.NEXTVAL INTO :NEW.ID 
FROM DUAL;
END;


CREATE OR REPLACE TRIGGER OBJEKAT_TRIGER BEFORE 
INSERT ON OBJEKAT
FOR EACH ROW 
BEGIN 
SELECT 
SK_OBJEKAT.NEXTVAL INTO :NEW.ID 
FROM DUAL;
END;

CREATE OR REPLACE TRIGGER NACELNIK_ZAMENIK_TRIGER BEFORE 
INSERT ON NACELNIK_ZAMENIK
FOR EACH ROW 
BEGIN 
SELECT 
SK_NACELNIK_ZAMENIK.NEXTVAL INTO :NEW.ID 
FROM DUAL;
END;